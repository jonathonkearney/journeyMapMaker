<!DOCTYPE html>

<html>
<head>

	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title>Journey Map</title>

<style>

body {
	
	margin: 0;
  padding: 0;
  height: 100%;
	
}

#parentDiv{
	display: flex;
    flex-direction: row;
	margin: .5vw;
}

.headerDiv{
	height:5vw;
	display: inline-flex;
	width: 127%;
}

#sideDiv{
	height:100%;
	width:25%;
	display: flex;
    flex-direction: column;
	background-color: #f7f3f3ab;
	z-index: 1;
	border-radius: 0.6vw;
	border-color: #e7dede7a;
	border-right-width: 0.5vw;
	border-right-style: solid;
}

#sonDiv{
	display: flex;
	flex-direction: column;
}

#sideTitleDiv{
	height:7%;
	font-size: 2vw;
	width: 90%;
	margin-left: 2vw;
	margin-bottom: 0vw;
	font-family: 'Montserrat', sans-serif !important;
}

#sideTitle{
	margin-top: 1vw;
	margin-right:1vw;
	margin-left: 0vw;
	margin-bottom: 0vw;
	color: #ca2020;
}

#insightsDiv{
	float: left;
	z-index: 1;
	height: 46%;
	margin-bottom: 1vw;
}
#valueDriversDiv{
	float: left;
	z-index: 1;
	height: 46%;
}

#insightsHeaderDiv{
	font-family: 'Montserrat', sans-serif !important;
	font-size: 1vw;
	margin-left:1.5vw;
	color: #4384a2fa;
}

#valueDriversHeaderDiv{
	font-family: 'Montserrat', sans-serif !important;
	font-size: 1vw;
	margin-left:1.5vw;
	color: #4384a2fa;
}

#insightsOLDiv{
	
}

.canvasWrapper{
	width: 70vw;
	height: 100%
}

.titleDiv{
	width: 100%;
	margin-left: 3vw;
}

.title{
	font-size: 2vw;
	width: 100%;
	margin: 1vw;
	margin-left:0;
	font-family: 'Montserrat', sans-serif !important;
}

#logo{
	height: 100%;
}

.createdByDiv{
	width: 20%;
	font-size: 0.9vw;
	font-family: 'Montserrat', sans-serif;
}

#createdBy{

}

.insightPointTitle{
	font-weight: bold;
	color: #4384a2fa;
	font-size: 0.7vw !important;
}
.valueDriversPointTitle{
	font-weight: bold;
	color: #4384a2fa;
	font-size: 0.7vw !important;
}

.rowHeadersDiv{
	width: 6vw;
    position: relative;
	margin-top: 0.3vw;
}


.my-shuffle-container{
	width: 60vw;
	float: left;
	margin-bottom: 1vw;
	margin-right: 4vw;
	overflow: visible !important;
	left: -4vw;
}

.column {
	float: left;
	width: 8vw;
	height:auto;
	overflow:visible;
	background-color: white;
	margin: 0.2vw;
}


.rowHeaderText{
	font-weight: bold;
	padding-top: 0vw;
	font-size: 0.5vw !important;
	margin-top:0.5vw;
	text-align-last: right;
	color: #4384a2fa;
}

.text{
	left: 0.5vw;
	top: 0vw;
	right: 0;
	text-align: left;
	/* font-family: 'Overpass', sans-serif; */
	/* font-family: 'Montserrat', sans-serif; */
	font-family: 'Lato', sans-serif;
	font-size: 0.6vw;
	z-index:2;
	display:table;
	width: 100%;
	
}

.rowHeaderTextDiv{ /*UNNEEDED */
	width: 5vw;
	margin: 0;
	float: left;
}

.rowHeaderFigure{

}

.rowHeader{
	font-weight: bold;
	padding-top: 0vw;
	font-size: 0.5vw !important;
	margin-top:0.4vw;
	text-align-last: right;
	color: #4384a2fa;
}

.rowHeaderDiv{
	width: 5vw;
	margin: 0;
	float: right;
	margin-right: 0.5vw;
}

.quoteText{
	font-weight: bold;
	font-style: italic;
}

.stageText{
	font-weight: bold;
	padding-top: 0vw;
	font-size:0.8vw;
	margin-top:0.5vw;
	color: #4384a2fa;
	width: 90%;
	margin-top: 0.2vw !important;
}

.subStageText{
	font-size: 0.7vw;
	color: #4384a2fa;
}

.line{
	position: absolute;
	width: 95%;
	height: 0;
	top: 1%;
	left: 0%;
	border-color: #4384a2fa;
	border-bottom-width: 0.05vw;
	border-bottom-style: solid;
}

.my-sizer-element { 
	margin-left: 0.8vw;
	visibility: hidden;
}

.paraText{
    margin-top: 0.4vw;
    margin-bottom: 0vw;
	width:90%;
	margin-left: 0.3vw;
}

.list{
	width:85%;
	margin: 0;
	padding-left: 1vw;
	margin-top: 0.3vw;
}

ul {
  list-style: none; /* Remove default bullets */
}

ul li::before {
	content: "\2022";  /* Add content: \2022 is the CSS Code/unicode for a bullet */
	color: gray; /* Change the color */
	font-weight: bold; /* If you want it to be bold */
	display: inline-block; /* Needed to add space between the bullet and the text */
	width: 1em; /* Also needed for space (tweak if needed) */
	margin-left: -1em; /* Also needed for space (tweak if needed) */
}

li:not(:last-child) {
    margin-bottom: 0.3vw;
}



ol {
  list-style: none;
  counter-reset: my-awesome-counter;
  margin-right: 2vw;
}
ol li {
  /* counter-increment: my-awesome-counter; */
  margin-bottom: 0.6vw !important;
  font-size: 0.6vw;
  font-family: 'Lato', sans-serif;
  
}
ol li::before {
  /* content: counter(my-awesome-counter) ". "; */
  color: #4384a2fa;
  font-weight: bold;
}

.liLine {
  border-color: #e7dede;
  border-top-width: 0.15vw;
  border-top-style: solid;
  width: 10%;
  margin-bottom: 0.5vw;  
}

#sideDivLine{
	width: 90%;
	height: 0;
	top: 1%;
	left: 0%;
	margin-left: 5%;
	border-color: #80808070;
	border-bottom-width: 0.2vw;
	border-bottom-style: dashed;
}

</style>
</head>

<body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.0.0/polyfill.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Shuffle/5.2.3/shuffle.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/4.1.5/lazysizes-umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/4.6.3/papaparse.js"></script>

<link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,600,700" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Oswald:700" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Overpass&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@300&display=swap" rel="stylesheet">

<div id="parentDiv">
	<div id="sideDiv">
		<div id="sideTitleDiv">
			<p id="sideTitle"><strong>Inspecting Organisations</strong></p>
		</div>
		<div id="insightsDiv">
			<div id="insightsHeaderDiv">
				<p class="insightsTitle"><strong>Key Insights</strong></p>
			</div>
			<div id="insightsOLDiv">
			</div>
		</div>
		<div id="sideDivLine"></div>
		<div id="valueDriversDiv">
			<div id="valueDriversHeaderDiv">
				<p><strong>Value Drivers</strong></p>
			</div>
			<div id="valueDriversOLDiv">
			</div>
		</div>
	</div>
	<div id="sonDiv">
		<div id="headerDiv" class="headerDiv">
			<div class="titleDiv">
				<p class="title"><strong>Understanding the Customer Experience</strong></p>
			</div>
			<div id="logoDiv">
				<img id="logo" src="WKLogo.jpg">
			</div>
			<div class="createdByDiv">
				<p id="createdBy">Created <strong>by: <br> Research and Analytics</strong></p>
			</div>
		</div>
		<div class="canvasWrapper">	
			<div id="container" class="row my-shuffle-container">
				<div class="column my-sizer-element"></div>
			</div>
		</div>
		
	</div>
</div>
<script>
	
	var insights =
	[
		[
			"Insight Title",
			"The insight Description goes here and it will be a somewhat long bit of text. Bla Bla. I could add some latin in here I guess. We talk about the insight here yes we do. yes we do.",
		],
		[
			"Another Insight Title",
			"The insight Description goes here and it will be a somewhat long bit of text. We talk about the insight here yes we do. yes we do.",
		],
		[
			"The Third Insight Title",
			"Aliquam quis ante id enim elementum vestibulum vel non erat. Nulla vel est eget augue efficitur pharetra. Nam imperdiet nunc quis tortor aliquet posuere. Nam placerat bibendum leo, nec elementum. We talk about the insight here yes we do. yes we do.",
		],
		[
			"And Another Insight Title",
			"The insight Description goes here and it will be a somewhat vitae posuere felis ex vel magna. Etiam vel semper urna. Nulla quis dolor ut eros feugiat sodales  long bit of text. We talk about the insight here yes we do. yes we do.",
		],
		[
			"The Last Insight Title",
			"The insight Description goes here and vitae ullamcorper sem efficitur sodales. Cras nec congue sem. Curabitur id scelerisque felis. Maecenas finibus erat non lacus malesuada it will be a somewhat long bit of text. We talk about the insight here yes we do. yes we do.",
		]
	];
	
	var valueDrivers =
	[
		[
			"Value Driver",
			"The Value Driver goes here and it will be a somewhat long bit of text. Quisque rhoncus metus eget velit faucibus, nec congue est bibendum. We talk about the value here yes we do. yes we do.",
		],
		[
			"Another Value Driver",
			"The Value Driver goes here and it will be a somewhat long bit of text. We talk about the value here yes we do. yes we do. Sed at dui nec erat vehicula congue. Vestibulum volutpat quam ligula.",
		],
		[
			"The Third Value Driver",
			"The Value Driver goes here and it will be a somewhat long bit of text. We talk about the value here yes we do. yes we do. Nulla in mi turpis. Vestibulum aliquam, ex et interdum aliquam, ante turpis imperdiet mi, sit amet lobortis",
		],
		[
			"And Another Value Driver",
			"The Value Driver goes here and it will be a somewhat long bit of text. Nulla vel est eget augue efficitur pharetra. Nam imperdiet nunc quis tortor aliquet posuere. Nam placerat bibendum leo, nec elementum lacus mollis sed.",
		],
		[
			"The Final Value Driver",
			"Nulla id odio magna. Vestibulum malesuada tortor non tincidunt molestie. Maecenas non odio lacinia, tincidunt nibh suscipit, eleifend neque. We talk about the value here yes we do. yes we do.",
		],
	];
	
	var newNewData =
	[
		[
			"Stage",
			"SubStage",
			"Quote", 
			"Needs",
			"PainPoints",
			"Behaviour",
			"Feelings"
		],
		[
			"Trigger",
			"Helping the Community",
			"Here is the Quote", 
			[
				"Here is a Need",
				"Need stuff goes in this section"
			],
			[
				"Here is a Painpoint",
				"Here is a Painpoint",
				"This is where we talk about PainPoints"
			],
			[
				"Here is a Behaviour",
				"Behaviour stuff goes here",
				"Here is a Behaviour"
			],
			[
				"Here is a Feeling",
				"What a feeling",
				"Here is a Feeling"
			]
		],
		[
			"",
			"License Required for Work",
			"This is a Quote from a participant. It may be quite a long quote or it may be quite short. Who knows", 
			[
				"Here is a Need",
				"Need Need, this is a Need"
			],
			[
				"This is where we talk about PainPoints, sometimes at length",
				"Here is a Painpoint",
				"Here is a Painpoint"
			],
			[
				"Here is a Behaviour",
				"Here is a Behaviour",
				"Behaviour Behaviour Behaviour"
			],
			[
				"The Feeling stuff goes here",
				"Here is a Feeling",
				"What a feeling"
			]
		],
		[
			"Pre-Application",
			"Researching what is needed",
			"Another quote goes here. It'll likely be at least this long", 
			[
				"Need stuff goes in this section",
				"Here is a Need",
			],
			[
				"Here is a Painpoint",
				"This section is all about PainPoints",
				"Here is a Painpoint"
			],
			[
				"Here is a Behaviour",
				"Here is a Behaviour",
				"Behaviour Behaviour Behaviour"
			],
			[
				"The Feelings that they had",
				"Feelings. Feelings.",
				"Here is a Feeling"
			]
		],
		[
			"Application Form",
			"Starting the form",
			"Here is a quote too. Its a quote. It's a good quote", 
			[
				"Here is a Need",
				"This is the Needs Section",
			],
			[
				"This is where we talk about PainPoints",
				"This is also where we talk about PainPoints",
				"Here is a Painpoint"
			],
			[
				"Behaviour stuff goes here",
				"Here is a Behaviour",
				"Here is a Behaviour"
			],
			[
				"Here is a Feeling",
				"Here is a Feeling",
				"The Feelings that they had"
			]
		],
		[
			"",
			"Middle of the form",
			"Another day another quote. A quote from a person we interviewed", 
			[
				"Here is a Need",
				"Needs"
			],
			[
				"Here is a where we mention some PainPoints",
				"Here is a Painpoint",
				"Here is a Painpoint"
			],
			[
				"Here is a Behaviour",
				"Behaviour stuff goes here",
				"Here is a Behaviour"
			],
			[
				"The Feelings that they had",
				"Here is a Feeling",
				"Here is a Feeling"
			]
		],
		[
			"",
			"End of the form",
			"This is a quote from a participant too. It may be quite a long quote or it may be quite short. I think this is about as long as it will get", 
			[
				"Here is a Need",
				"Here is a Need"
			],
			[
				"Here is a Painpoint",
				"Here is a Painpoint",
				"This is where we list the PainPoints they had"
			],
			[
				"Behaviour stuff goes here",
				"Here is a Behaviour",
				"Here is a Behaviour"
			],
			[
				"Here is a where we talk about Feelings. The Feelings stuff goes here",
				"Feelings. Feelings",
				"Here is a Feeling"
			]
		],
		[
			"Payment",
			"Sending off payment",
			"Here is a quote, a short quote", 
			[
				"Here is a Need",
				"Here is a Need"
			],
			[
				"Here is a Painpoint",
				"Here is a Painpoint",
				"Painpoints. Painpoints"
			],
			[
				"Behaviour stuff goes here",
				"Here is a Behaviour",
				"Behaviour stuff goes here"
			],
			[
				"Here is a Feeling",
				"The Feelings stuff goes here",
				"Here is a Feeling"
			]
		],
		[
			"Site Assessment",
			"Having a site assessment",
			"Here is a quote, a quote, a quote", 
			[
				"Here is a Need",
				"This is where we talk about their Needs"
			],
			[
				"PainPoints. PainPoints",
				"Here is a Painpoint",
				"This is where we talk about PainPoints"
			],
			[
				"Here is a Behaviour",
				"Here is a Behaviour",
				"Here is a Behaviour"
			],
			[
				"Feelings and some more Feelings",
				"Here is a Feeling",
				"Here is a where we talk about Feelings. The Feelings stuff goes here"
			]
		],
		[
			"",
			"Site asessment feedback",
			"Here is the quote. Almost the last quote. one more to my right", 
			[
				"Here is a Need",
				"Need stuff goes in this section"
			],
			[
				"Here is a Painpoint",
				"Here is a Painpoint",
				"Here is a Painpoint"
			],
			[
				"Here is a Behaviour",
				"Here is a Behaviour",
				"Here is a Behaviour"
			],
			[
				"Feelings and some more Feelings",
				"Here is a Feeling",
				"Here is a where we talk about Feelings. The Feelings stuff goes here"
			]
		],
		[
			"Post-Application",
			"waiting on confirmation",
			"Here is the quote. the final quote. It's a goody", 
			[
				"Need stuff goes in this section",
				"Here is a Need"
			],
			[
				"Here is a Painpoint",
				"This section is all about PainPoints",
				"Here is a Painpoint"
			],
			[
				"Here is a Behaviour",
				"Here is a Behaviour",
				"Behaviour Behaviour Behaviour"
			],
			[
				"The Feeling stuff goes here",
				"Here is a Feeling",
				"What a feeling"
			]
		],
	];
	
	var data = [];
	
	var maxHeights = [];
	var minFirstRowHeight = 1.5;
	var minRowHeight = 2;
	
	//Smaller number = bigger box
	var heightNumber = 22; 
	var arrayHeightNumber = 18
	
	var keys = [];
	
	var animationSpeed = 750; 
	
	//****** SHUFFLE ******\\
	
	var Shuffle = window.Shuffle;
	var element = document.querySelector('.my-shuffle-container');
	var sizer = element.querySelector('.my-sizer-element');

	var shuffleInstance = new Shuffle(element, {
		itemSelector: '.shuffle-item',
		sizer: sizer,
		speed: animationSpeed,
		filterMode: Shuffle.FilterMode.ALL,
		gutterWidth: 5,
	});
	
	main();
	
	function main(theData) { 
		
		data = newNewData;
		console.log(data);
		getKeys();
		setContainerWidth();
		getMaxHeights();
		appendBoxesMk3();
		generateInsightsList()
		generateValueDriversList();
	}
	
	function parseData(url, callBack) {
		Papa.parse(url, {
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) {
				callBack(results.data);
			}
		});
	}
	
	//****** ADD IN BOXES ******\\
	
	//add the boxes to the shuffleInstance
	function appendBoxesMk3() {
	
		//var elements = generateBoxesMk2();
		//var elements = generateBoxesMk3();
		var elements = generateBoxesMk4();

		elements.forEach(function (element) {
			this.element.appendChild(element);
		}, this);

		shuffleInstance.add(elements);
		shuffleInstance.update();
	};
	
	function getMaxHeights(){
		
		var rowHasArray = [];
		
		for (var i = 0; i < keys.length; i++) {
			maxHeights.push(0);
			rowHasArray.push(false);
		}
		
		for(var i = 0; i < keys.length; i++){
			for(var j = 0; j < data.length; j++){
				
				var charCount = 0;
				
				if(Array.isArray(data[j][i])){ //if the key (stage, substage, etc) at the column its up to is an array
					rowHasArray[i] = true;
					const reducer = (accumulator, currentValue) => accumulator + currentValue;
					var flattened = data[j][i].reduce(reducer);
					charCount = flattened.length;
				}
				else{
					charCount = charCount + data[j][i].length;
				}
				
				if(charCount > maxHeights[i]){
					maxHeights[i] = charCount;
				}
			}
		}
		
		//reduce them to a good viewWidth size
		for(var i = 0; i < maxHeights.length; i++){
		
			if(rowHasArray[i] == true){
				maxHeights[i] = maxHeights[i] / arrayHeightNumber;
			}
			else{
				maxHeights[i] = maxHeights[i] / heightNumber;
			}
		}
		
		//set them to at least the minimum
		for(var i = 0; i < maxHeights.length; i++){
			if(i == 0){
				console.log(maxHeights[i]);
				if(maxHeights[i] < minFirstRowHeight){
					maxHeights[i] = minFirstRowHeight;
				}
			}
			else{
				if(maxHeights[i] < minRowHeight){
					maxHeights[i] = minRowHeight;
				}
			}
		}
		
		//Add the view widths
		for(var i = 0; i < maxHeights.length; i++){
			var height = "";
			height = height.concat(maxHeights[i], "vw");
			maxHeights[i] = height;
		}
		
		
		console.log(maxHeights);
	}
	
	function generateBoxesMk4(){
		
		var items = [];
		
		for(var i = 0; i < keys.length; i++){
			for(var j = 0; j < data.length; j++){
				
				//make the figure and give it classes
				var box = document.createElement('figure'); //create a figure
				var boxClassName = "";
				
				if(j == 0){//if its the first column
					boxClassName = boxClassName.concat("column aspect rowHeaderFigure ");
				}
				
				boxClassName = boxClassName.concat("column aspect ", keys[i], "Box");
				box.className = boxClassName;
				box.style.height = maxHeights[i];
				
				
				if(j == 0){//if its the first column
					
					//make the text div and give it classes
					var rowHeaderDiv = document.createElement('div'); //create a Div for text
					rowHeaderDiv.className = "rowHeaderDiv";
					
					//make the paragraph and give it classes
					var rowHeader = document.createElement('P');
					rowHeader.className = "rowHeader";
					
					//make the text
					var rowHeaderText = document.createTextNode(data[j][i]);		
					
					rowHeader.appendChild(rowHeaderText); //add the text to the paragraph
					rowHeaderDiv.appendChild(rowHeader); //add the paragraph to the div

					box.appendChild(rowHeaderDiv); //add the div to box
					
				}
				else{//if its any of the other columns
				
					if(i != 0){//if its not the top row then create the line and give it a class
						var line = document.createElement('div');
						line.className = "line";
						
						//if the box up and right of it is blank then make your line connect up

						if(j < data.length -1 && data[j+1][i-1] === ""){
							console.log("the one up and right is blank")
							line.style.width = "140%";
						}
						
						box.appendChild(line);
					}
					
					//make the text div and give it classes
					var paraTextDiv = document.createElement('div'); //create a Div for text
					var paraTextDivClassName = "";
					paraTextDivClassName = paraTextDivClassName = (keys[i], "textDiv");
					paraTextDiv.className = paraTextDivClassName;
					
					if(Array.isArray(data[j][i])){ //if the key (stage, substage, etc) at the column its up to is an array
						
						//LIST VERSION
						var list = document.createElement('ul')
						var listClassName = "";
						listClassName = listClassName.concat(keys[i], "Text ", "text paraText list");
						list.className = listClassName
						
						var arrayLength = data[j][i].length;
						for(var k = 0; k < arrayLength; k++){
							
							var li = document.createElement('li');
							
							var listText = "";
							if(keys[i] == "quote" || keys[i] == "quotes" || keys[i] == "Quote" || keys[i] == "Quotes"){
								listText = document.createTextNode('"' + data[j][i][k] + '"');
							}
							else{
								listText = document.createTextNode(data[j][i][k]);
							}
							
							li.appendChild(listText);
							list.appendChild(li);
							paraTextDiv.appendChild(list);
							
						}
					}
					else{
						//make the paragraphc and give it classes
						var para = document.createElement('P');
						var paraClassName = "";
						paraClassName = paraClassName.concat(keys[i], "Text ", "text paraText");
						para.className = paraClassName;
						
						//make the text
						var paraText = document.createTextNode(data[j][i]);
						var paraText = "";
						if(keys[i] == "quote" || keys[i] == "quotes" || keys[i] == "Quote" || keys[i] == "Quotes"){
							paraText = document.createTextNode('"' + data[j][i] + '"');
						}
						else{
							paraText = document.createTextNode(data[j][i]);
						}		
						
						para.appendChild(paraText); //add the text to the paragraph
						paraTextDiv.appendChild(para); //add the paragraph to the div
					}

					box.appendChild(paraTextDiv); //add the div to box
				}
				items.push(box);
			}
		}
		return items;
	}
	
	function setContainerWidth(){
		
		console.log(element.querySelector('.my-sizer-element'));
		var containerWidthNumber = 8 * (data.length * 1.1); //the column width * the number of columns. the 1.1 is to make up for the gutter
		containerWidth = "";
		containerWidth = containerWidth.concat(containerWidthNumber, "vw");
		document.getElementById("container").style.width = containerWidth;
		console.log(containerWidth);
		
		//set the header width too while we are at it
		document.getElementById("headerDiv").style.width = containerWidth *0.95;
	}
	function capitalizeFirstLetter(string) {
		return string.charAt(0).toUpperCase() + string.slice(1);
	}
		function decapitalizeFirstLetter(string) {
		return string.charAt(0).toLowerCase() + string.slice(1);
	}
	
	function getKeys(){
		
		for(var i = 0; i < data[0].length; i++){ //go through first data column
			keys.push(decapitalizeFirstLetter(data[0][i]));
		}
	}
	
	function generateInsightsList(){
		document.getElementById("sideDiv").style.height = document.getElementById("sonDiv").style.height;
		
		var list = document.createElement('ol')
		list.id = "insightsOL"
		
		
		for(var i = 0; i < insights.length; i++){
			
			var li = document.createElement('li');
			var liDiv = document.createElement('div');
			liDiv.className = "liLine";
			li.appendChild(liDiv);
			
			for(var j = 0; j < 2; j++){
				
				if(j == 0){
					var span = document.createElement('SPAN');
					span.className = "insightPointTitle";
					var listText = document.createTextNode(insights[i][j] + ": ");
					span.appendChild(listText);
					li.appendChild(span);
				}
				else{
					var listText = document.createTextNode(insights[i][j]);
					li.appendChild(listText);
				}
				
			}
			
			list.appendChild(li);
			document.getElementById("insightsOLDiv").appendChild(list);
		}
		
	}
	
	function generateValueDriversList(){
		
		var list = document.createElement('ol')
		list.id = "valueDriversOL"
		
		
		for(var i = 0; i < valueDrivers.length; i++){
		
			var li = document.createElement('li');
			var liDiv = document.createElement('div');
			liDiv.className = "liLine";
			li.appendChild(liDiv);
			
			for(var j = 0; j < 2; j++){
				
				if(j == 0){
					var span = document.createElement('SPAN');
					span.className = "valueDriversPointTitle";
					var listText = document.createTextNode(valueDrivers[i][j] + ": ");
					span.appendChild(listText);
					li.appendChild(span);
				}
				else{
					var listText = document.createTextNode(valueDrivers[i][j]);
					li.appendChild(listText);
				}
				
			}
				
			list.appendChild(li);
			document.getElementById("valueDriversOLDiv").appendChild(list);
		}
		
	}
	
	
</script>

</body>
</html>